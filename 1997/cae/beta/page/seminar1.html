<!-- init section -->

	<head>
		<title>Seminar 1 - Applikationen und Rahmenfenster</title>
	</head>
	<body bgcolor="#ffffff" text="#000000" alink="#ff0000" vlink="#002080" link="#0f00ff">
	<font face="VERDANA, ARIAL, HELVETICA">
	<center>
	<table>



<!-- title section -->

	<table border=0 cellspacing=0 cellpadding=0 width=600>
	<font face="Arial, Helvetica" size=1>
		<tr>
			<td width=150><a href=/~bauinf><img src=../art/top-root.gif alt="root" width=150 height=25 border=0 vspace=0></a><br></td>
			<td width=150><a href=/~bauinf/lehre/lehre.html><img src=../art/top-back.gif alt="previous" width=150 height=25 border=0 vspace=0></a><br></td>
			<td width=150><a href=../index.html><img src=../art/top-index.gif alt="index" width=150 height=25 border=0 vspace=0></a><br></td>
		</tr>
	</table>


<!-- page section -->

	<table border=0 cellspacing=0 cellpadding=0 width=600>
		<tr>
			<td bgcolor=#ffffff text=#000000 width=600 valign=top align=left>
			<font face="Verdana,Arial, Helvetica" size=2>
			<br>
			<hr size=1>
			<blockquote>
			Die folgenden Seminare haben die Implementierung einer Beispielapplikation zum Inhalt. &uuml;ber eine graphische Benutzeroberfl&auml;che soll die Eingabe einer Querschnittsgeometrie (Polygonzug) erm&ouml;glicht werden. Diese sollen graphisch visualisiert werden. &uuml;ber eine entkoppelte Berechnungskomponente sollen zu der Geometrie Querschnittswerte berechnet werden.
			<p>
			Anhand dieses Beispiels sollen die Entwicklung graphischer Benutzeroberfl&auml;chen, die Visualisierung durch graphische Primitiva und die Entwicklung von Softwarekomponenten gezeigt werden. Dabei werden die Microsoft Foudation Classes verwendet.
			</blockquote>
			
			<hr size=1>
			<br><h1><b>Seminar 1</i></b></h1>
			<hr size=1>
			<br><h2><b>Applikationen und Rahmenfenster</i></b></h2>
			<blockquote>
			 In diesem Seminar wird das Betriebssystem Windows NT, die Visual C++ Entwicklungsumgebung und eine Klassenbibliothek (MFC) vorgestellt.
			Es wird eine erste Win32-Applikation mit Hilfe der MFC-Klassen CMDIFrameWnd und CWinApp erstellt. Dabei wird auch eine Resource erzeugt (Men&uuml; und Titel).
			</blockquote>
			<br><h3><b>Kennenlernen des Betriebssystems Windows NT 4.0</i></b></h4>
			<blockquote>
			Windows NT ist ein Multitasking-Betriebssystem mit einer durchgehenden Auslegung auf eine 32-Bit-Umgebung. Wichtige grundlegende Bestandteile des Systems sind die durchg&auml;ngigen Sicherheitsfunktionen und die eingebauten Netzwerkdienste.
			Windows NT ist ein modulares Betriebssystem. Das heißt, es setzt sich aus vielen, relativ einfachen Modulen zusammen, die leicht ausgetauscht werden können. Durch diesen Aufbau ist eine &auml;usserst flexible Anpassung an Hard- und Software möglich.
			</blockquote>
			<br><h3><b>Die Entwicklungsumgebung des Microsoft Visual C++ Kompilers (Developer Studio)</i></b></h4>
			<img src=art/msds_bereiche.gif border=0>
			<blockquote>
			Das Microsoft Developer Studio 97 verf&uuml;gt &uuml;ber 3 Bereiche:
				<ol>
				<li>Der Arbeitsbereich dient zur Projekt&uuml;bersicht. Standardm&auml;ßig ist die Klassen&uuml;bersicht (ClassView) eingestellt. Weitere Fenster sind die Datei&uuml;bersicht (FileView), das Infofenster (Infoview) und die Ressourcen&uuml;bersicht (Ressource View).
				In den Arbeitsbereich gelangt man durch die Tastaturkombination [ALT] + [0]. Ein Doppelklick auf eine Datei im FileView l&auml;dt diese zur Bearbeitung im Editor.
				<p>
				<li>Der Editor dient zur Bearbeitung des Quelltextes. Er verf&uuml;gt &uuml;ber alle ben&ouml;tigten Funktionen (Cut, Copy, Paste etc.).
				<p>
				<li>Das Ausgabefenster dient zur Ausgabe von Kompilermeldungen, zum Debugging und zur Suche in Dateien.
				</ol>
			</blockquote>
			<br><h3><b>Erstellen einer Applikation mit einem Rahmenfenster</b></h3>
			<blockquote>
				Notationsvereinbarungen:<br>
					<ul>
					<li>Klassennamen werden nicht wie &uuml;blich als "CKlassenname" gew&auml;hlt, sondern nur "Klassenname" (ohne C).<br>
					<li>Globale und klasseninterne Attribute werden nicht wie &uuml;blich durch ein vorangestelltes m_ unterschieden, sondern nur durch einen Unterstrich  _ (z.B. _x; _y).<br>
					</ul>
				<p>				
				<ol>
				<li>Starten Sie das Developer Studio.<br><p>
				<p>
				<li>W&auml;hlen Sie im Men&uuml; Datei-Neu .<br><p>
				<p>
				<li>Es erscheint nun ein Dialog zur Auswahl des anzulegenden Datei- oder Projekttyps. W&auml;hlen Sie "Win32 Application". Hiermit haben Sie bestimmt, daß das Projekt eine Windows Fenster-Applikation ist. Geben sie den Projektnamen und den Pfad ein.<br><p>
				<p>
				<img src=art/msds_neu.gif><p>
				<li>W&auml;hlen Sie nun Projekt-Einstellungen ([ALT]+[F7]).<br><p>
				<p>
				<li>In diesem Dialog k&ouml;nnen Sie die Einstellungen f&uuml;r die Release- und die Debugversion ihres Projektes &auml;ndern. Die Releaseversion ist die Version, die f&uuml;r gew&ouml;hnlich die verkaufsfertige Variante der Software darstellt. Die Debugversion dient der Erstellung und Bearbeitung der Software und zur Fehlersuche. Stellen Sie die Microsoft Foundation Classes in der Win32-Release-Version auf "MFC in einer Statischen Bibiothek verwenden" und in der Win32-Debug-Version auf "MFC in einer gemeinsam genutzten DLL verwenden". Von nun an kann die MFC-Klassenbibliothek in ihrem Projekt verwendet werden.<br><p>
				<p>
				<img src=art/msds_projekteinst.gif><p>
				<li>Erstellen Sie nun eine neue C++-Quellcodedatei mit dem Namen "seminar.cpp" und eine neue C/C++-Haeder-Datei mit dem Namen "seminar.h".<br><p>
				<p>
				<li>Geben Sie den folgenden Quellcode in der Header-Datei ein:<br><p>
				<table border=1><tr><td bgcolor=#000000>
				<font color=#ffffff size=2>
				seminar.h
				</font><tr><td>
					<pre>
#ifndef __seminar__
#define __seminar__

/////////////////////////////////////////////////////////////////////////////
// class MainFrame

class MainFrame : public CFrameWnd
{
  DECLARE_DYNAMIC(MainFrame)
};

/////////////////////////////////////////////////////////////////////////////
// class Application

class Application : public CWinApp
{
  public:
  virtual BOOL InitInstance();
};

#endif
					</pre>
				</table>
				<br>
					<ul>
					<li>Der Datentyp BOOL kann die Werte TRUE oder FALSE haben.
					<li>Das Schl&uuml;sselwort virtual dient zur Neuimplementation von bereits vorhandenen Funktionen der Elternklasse.
					</ul>
				<p>
				<li>Geben Sie den folgenden Quellcode in der CPP-Datei ein:<br><p>
				<table border=1><tr><td bgcolor=#000000>
				<font color=#ffffff size=2>
				seminar.cpp
				</font><tr><td>
					<pre>
#include &lt;afxwin.h&gt;
#include "seminar.h"

/////////////////////////////////////////////////////////////////////////////
// class MainFrame

IMPLEMENT_DYNAMIC(MainFrame,CFrameWnd)

/////////////////////////////////////////////////////////////////////////////
// class Application

Application _Application;

BOOL Application::InitInstance()
{
  Enable3dControls();

  MainFrame * Frame = new MainFrame;

  if (!Frame->Create(NULL,"Fenstertitel"))
    return FALSE;

  m_pMainWnd = Frame;

  m_pMainWnd->ShowWindow(m_nCmdShow);
  m_pMainWnd->UpdateWindow();
    
  return TRUE;
}
					</pre>
				</table>
				<br>
					<ul>
					<li>Mit "Application _Application" wird die Applikation angelegt. Sie ist von Datentyp Application und heißt  "_Application".<br>
					<li>"InitInstance" wird beim Erzeugen von "_Application" automatisch aufgerufen.<br>
					<li>"Enable3dControls()" erm&ouml;glicht die Darstellung der Fenster und Dialoge im Windows-95-Stil.<br>
					<li>Die folgende Graphik zeigt den Vererbungsbaum der Klassen Application und FrameWindow.<br>
					<p><img src=art/sem1_app_wnd_baum.gif><br><p>
					</ul>
				<p>
				<li>Kompilieren Sie seminar.cpp ([STRG]+[F7]). Beim Start des Programmes ([STRG]+[F5]) sollte ein Rahmenfenster mit dem Namen "Fenstertitel" erscheinen.<br><p>
				<p>
				<li>Erzeugen Sie nun ein neues Ressourcenscript (Datei-Neu) mit dem Namen "seminar". Das Arbeitsbereich-Fenster schaltet automatisch in den Ressourcen-Modus.<br><p>
				<p>
				<li>Klicken Sie im Editor-Fenster auf "seminar.rc" und f&uuml;gen Sie eine neue Ressource von Typ "String Table" ein. W&auml;hlen Sie dazu den Men&uuml;punkt Einf&uuml;gen-Ressource oder dr&uuml;cken Sie [STRG]+[R]. Doppelklicken Sie auf den ersten Eintrag und geben Sie f&uuml;r die ID "IDR_MAIN_FRAME" und f&uuml;r die Beschriftung "Seminar" ein.<br><p>
				<img src=art/msds_string_eigensch.gif><br><p>
				<li>Erzeugen Sie als weitere Ressource ein Men&uuml; ([CTRL]+[R]). Das Men&uuml; sollte dem auf der folgenden Abbildung entsprechen:<br><p>
				<img src=art/msds_sem1_menu.gif><br><p>
				<ul>
				<li>Die ID des Men&uuml;s ist "IDR_MAIN_FRAME" (Zum Einstellen Doppelklick auf Men&uuml;leiste).
				<p>
				<li>Um den Buchstaben f&uuml;r die [ALT]-Tastaturkombination eines Eintrages im offenen Men&uuml; zu markieren, verwenden Sie ein dem Buchstaben vorangestelltes "&". Die allgemeine Tastaturkombination wird nach dem Eintragtext mit "\t"+"Tastenkombination" eingegeben. Die Eintr&auml;ge lauten dann "&New\tCtrl+N", "&Close" und "E&xit\tAlt+F4".
				<p>
				<li>Die ID des "New" Eintrages ist "ID_FILE_NEW".
				<p>
				<li>Die ID des "Close Eintrages ist "ID_FILE_CLOSE".
				<p>
				<li>Die ID des "Exit" Eintrages ist "ID_APP_EXIT".
				</ul>
				<p>
				<li>&Auml;ndern Sie die Datei seminar.cpp seminar.h. Die &Auml;nderungen sind <font color=#ff0000>rot</font> markiert.<br><p>
				<table border=1><tr><td bgcolor=#000000>
				<font color=#ffffff size=2>
				seminar.h
				</font><tr><td>
					<pre>
#ifndef __seminar__
#define __seminar__

/////////////////////////////////////////////////////////////////////////////
// class MainFrame

class MainFrame : public C<font color=#ff0000>MDI</font>FrameWnd
{
  DECLARE_DYNAMIC(MainFrame)
};

/////////////////////////////////////////////////////////////////////////////
// class Application

class Application : public CWinApp
{
  public:
  virtual BOOL InitInstance();
};

#endif
					</pre>
				</table>
				<p>
				<table border=1><tr><td bgcolor=#000000>
				<font color=#ffffff size=2>
				seminar.cpp
				</font><tr><td>
					<pre>
#include &lt;afxwin.h&gt;
<font color=#ff0000>#include "resource.h"</font>
#include "seminar.h"

/////////////////////////////////////////////////////////////////////////////
// class MainFrame

IMPLEMENT_DYNAMIC(MainFrame,C<font color=#ff0000>MDI</font>FrameWnd)

/////////////////////////////////////////////////////////////////////////////
// class Application

Application _Application;

BOOL Application::InitInstance()
{
  Enable3dControls();

  MainFrame * Frame = new MainFrame;
<font color=#ff0000>

   if (!Frame->LoadFrame(IDR_MAIN_FRAME))
</font>
    return FALSE;

  m_pMainWnd = Frame;

  m_pMainWnd->ShowWindow(m_nCmdShow);
  m_pMainWnd->UpdateWindow();
    
  return TRUE;
}
					</pre>
				</table>
				<p>
				<li>Kompilieren Sie seminar.cpp ([STRG]+[F7]). Beim Start des Programmes ([STRG]+[F5]) sollte ein Rahmenfenster mit dem Namen "Seminar" und dem erstellten Men&uuml; erscheinen.<br><p>
				<img src=art/sem1_screenshot.gif><br><p>
				<li>Die folgende Abbildung zeigt die Struktur des im Seminar erstellten Projektes.<br>
				<p>
				<img src=art/sem1_struktur.gif><br>
				<p>
				</ol>
			</blockquote>
		</tr>
	</table>


<!-- author section -->
	<!-- author: Karsten Koch 1997-->
	<table width=600>
		<tr><td>
		<hr size=1 width=600>
        	<center>
        	<font size=2>
        Lehrstuhl f&uuml;r Informatik im Bauwesen, BUW
	        </font>
	        </center>
		</td></tr>
	</table>

<!-- end section -->
	</table>
	</center>
	</body>